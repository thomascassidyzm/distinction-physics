---
/**
 * Note Component
 *
 * Renders footnotes, sidenotes, and editorial comments.
 */

interface Props {
  /** Type of note */
  variant: 'footnote' | 'sidenote' | 'marginalia' | 'editorial' | 'technical';
  /** Optional label/number for footnotes */
  label?: string;
}

const { variant, label } = Astro.props;

const icons: Record<typeof variant, string> = {
  footnote: '†',
  sidenote: '※',
  marginalia: '○',
  editorial: '✎',
  technical: '⚙',
};
---

<aside class:list={['note', `note-${variant}`]} role="note">
  {label ? (
    <span class="note-label">{label}</span>
  ) : (
    <span class="note-icon">{icons[variant]}</span>
  )}
  <span class="note-content">
    <slot />
  </span>
</aside>

<style>
  .note {
    display: flex;
    gap: 0.5rem;
    font-size: 0.875rem;
    line-height: 1.6;
    color: var(--text-secondary, #a0a0b8);
  }

  .note-label,
  .note-icon {
    flex-shrink: 0;
    font-family: var(--font-mono, 'JetBrains Mono', monospace);
    font-size: 0.75rem;
  }

  .note-content {
    flex: 1;
  }

  /* Footnote: inline, smaller */
  .note-footnote {
    margin: 1rem 0;
    padding-left: 1rem;
    border-left: 2px solid var(--border, #2a2a3a);
  }

  .note-footnote .note-label {
    color: var(--accent, #4a9eff);
    font-weight: 500;
  }

  /* Sidenote: floated to margin on desktop */
  .note-sidenote {
    background: var(--depth-1, #12121a);
    padding: 0.75rem 1rem;
    border-radius: 6px;
    margin: 1rem 0;
  }

  @media (min-width: 1200px) {
    .note-sidenote {
      position: absolute;
      right: -280px;
      width: 240px;
      margin: 0;
      font-size: 0.8125rem;
    }
  }

  .note-sidenote .note-icon {
    color: var(--text-muted, #606080);
  }

  /* Marginalia: subtle inline note */
  .note-marginalia {
    font-style: italic;
    margin: 0.5rem 0;
    padding: 0.5rem 0;
  }

  .note-marginalia .note-icon {
    color: var(--text-muted, #606080);
  }

  /* Editorial: author/editor comment */
  .note-editorial {
    background: rgba(168, 85, 247, 0.1);
    border: 1px solid rgba(168, 85, 247, 0.2);
    padding: 0.75rem 1rem;
    border-radius: 6px;
    margin: 1rem 0;
  }

  .note-editorial .note-icon {
    color: #a855f7;
  }

  /* Technical: implementation/formal note */
  .note-technical {
    background: rgba(74, 158, 255, 0.1);
    border: 1px solid rgba(74, 158, 255, 0.2);
    padding: 0.75rem 1rem;
    border-radius: 6px;
    margin: 1rem 0;
    font-family: var(--font-mono, 'JetBrains Mono', monospace);
  }

  .note-technical .note-icon {
    color: var(--accent, #4a9eff);
  }
</style>
